{
  "question_text": "HOTSPOT<br/> -<br/><br/>You have a Fabric workspace that contains a lakehouse named Lakehouse1. Lakehouse1 contains a table named Status_Target that has the following columns:<br/><br/>•\tKey<br/>•\tStatus<br/>•\tLastModified<br/><br/>The data source contains a table named Status_Source that has the same columns as Status_Target. Status_Source is used to populate Status_Target.<br/><br/>In a notebook name Notebook1, you load Status_Source to a DataFrame named sourceDF and Status_Target to a DataFrame named targetDF.<br/><br/>You need to implement an incremental loading pattern by using Notebook1. The solution must meet the following requirements:<br/><br/>•\tFor all the matching records that have the same value of key, update the value of LastModified in Status_Target to the value of LastModified in Status_Source.<br/>•\tInsert all the records that exist in Status_Source that do NOT exist in Status_Target.<br/>•\tSet the value of Status in Status_Target to inactive for all the records that were last modified more than seven days ago and that do NOT exist in Status_Source.<br/><br/>How should you complete the statement? To answer, select the appropriate options in the answer area.<br/><br/>NOTE: Each correct selection is worth one point.<br/><br/><img src=\"images/dp-700_topic-2_question-27_html_1.png\"/>",
  "question_images": [
    "images/dp-700_topic-2_question-27_question_1.png"
  ],
  "answers": {},
  "answer_images": {},
  "correct_answer": [],
  "correct_answer_images": [
    "images/dp-700_topic-2_question-27_correct_1.png"
  ],
  "discussion": "whenMatchedUpdate is used to update existing records — here, just LastModified.\n\nwhenNotMatchedInsert handles inserting new records into the target from the source.\n\nwhenNotMatchedBySourceUpdate is key for handling records that are no longer present in the source and meet a time-based condition (older than 7 days), marking them as \"inactive\".\n\nSeems Correct\n\ntargetDF.merge(sourceDF, \"sourceDF.Key = targetDF.Key\") \\\n    .whenMatchedUpdate(\n        set = {\"targetDF.LastModified\": \"sourceDF.LastModified\"}\n    ) \\\n    .whenNotMatchedInsert(\n        values = {\n            \"targetDF.Key\": \"sourceDF.Key\",\n            \"targetDF.LastModified\": \"sourceDF.LastModified\",\n            \"targetDF.Status\": \"sourceDF.Status\"\n        }\n    ) \\\n    .whenNotMatchedBySourceUpdate(\n        condition = \"targetDF.LastModified > (current_date() - INTERVAL '7' DAY)\",\n        set = {\"targetDF.Status\": \"'inactive'\"}\n    ) \\\n    .execute()\n\n.whenMatchedUpdate\n.whenNoMatchedBySourceInsert\n.whenNotMatchedUpdate",
  "question_type": "image_only",
  "exam": "dp-700",
  "topic": 2,
  "question_number": 27,
  "url": "https://www.examtopics.com/discussions/microsoft/view/302721-exam-dp-700-topic-2-question-27-discussion/"
}