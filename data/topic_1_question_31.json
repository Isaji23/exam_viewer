{
  "question_text": "DRAG DROP -<br/>You have a Fabric workspace that contains a warehouse named Warehouse1.<br/>In Warehouse1, you create a table named DimCustomer by running the following statement.<br/><img src=\"https://img.examtopics.com/dp-700/image22.png\" title=\"image23\"/><br/>You need to set the Customerkey column as a primary key of the DimCustomer table.<br/>Which three code segments should you run in sequence? To answer, move the appropriate code segments from the list of code segments to the answer area and arrange them in the correct order.<br/><img src=\"https://img.examtopics.com/dp-700/image23.png\" title=\"image24\"/>",
  "question_images": [
    "https://img.examtopics.com/dp-700/image22.png",
    "https://img.examtopics.com/dp-700/image23.png"
  ],
  "answers": {},
  "answer_images": {},
  "correct_answer": [],
  "correct_answer_images": [
    "https://img.examtopics.com/dp-700/image24.png"
  ],
  "discussion": "Alter table dbo.dimcustomer\nAdd constraint PK_dimcustomer primary key nonclustered (customerkey) \nnot enforced \n\nPRIMARY KEY is only supported when NONCLUSTERED and NOT ENFORCED are both used.\nhttps://learn.microsoft.com/en-us/fabric/data-warehouse/table-constraints\n\nThis is correct, \nPrimary Key\nNon Clustered\nNot Enforced\n\nhttps://learn.microsoft.com/en-us/fabric/data-warehouse/table-constraints\n\nALTER TABLE dbo.DimCustomer\nADD CONSTRAINT PK_DimCustomer PRIMARY KEY CLUSTERED (CustomerKey)\nENFORCED\n\nThis is the correct option, I have tired it in my warehouse\nALTER TABLE [dbo].[dim_cust]\nADD CONSTRAINT [PK_dim_cust_CustomerKey] PRIMARY KEY NONCLUSTERED (CustomerKey) NOT ENFORCED\n\nPrimary Key\nNon Clustered\nNot Enforced\n\nPrimary Key\nNon Clustered\nNot enforced\n\nAs a SQL developer I would use CLUSTERED and ENFORCED in SQL Server. But this appears to be a particular constraint within Fabric. The Details are as follows.\n\n \"SQL analytics endpoint and Warehouse in Microsoft Fabric support these table constraints:\n\nPRIMARY KEY is only supported when NONCLUSTERED and NOT ENFORCED are both used\"\n\nSource: https://learn.microsoft.com/en-us/fabric/data-warehouse/table-constraints\n\nALTER TABLE myTable \nADD CONSTRAINT PK_myTable \nPRIMARY KEY CLUSTERED (c1) \nENFORCED;\nPRIMARY KEY must be enforced to guarantee uniqueness and non-null values.\nNOT ENFORCED is only valid for FOREIGN KEY or CHECK constraints, not for PRIMARY KEY.\n\nhttps://learn.microsoft.com/en-us/fabric/data-warehouse/table-constraints\nThe given example is:\nCREATE TABLE PrimaryKeyTable (c1 INT NOT NULL, c2 INT);\nTo add PK:\nALTER TABLE PrimaryKeyTable \nADD CONSTRAINT PK_PrimaryKeyTable PRIMARY KEY NONCLUSTERED (c1) \nNOT ENFORCED;\n\nso answer is\nALTER TABLE\nNONCLUSTERED\nNOT ENFORCED\n\nALTER TABLE\nNONCLUSTERED \nNOT ENFORCED\n\nALTER TABLE dbo.dimcustomer\nADD CONSTRAINT PK_DimCustomer PRIMARY KEY NONCLUSTERED (customerkey)\nnot ENFORCED\n\nthis is the right answer\n\nAlter table dbo.dimcustomer\nAdd constraint PK_dimcustomer primary key nonclustered (customerkey)\nnot enforced\n\nAlter table dbo.dimcustomer\nAdd constraint PK_dimcustomer primary key nonclustered (customerkey)\nnot enforced - This is from Microsoft documentation\n\nThe provided answer is wrong Alter table dbo.dimcustomer\nAdd constraint PK_dimcustomer primary key nonclustered (customerkey)\nnot enforced  https://learn.microsoft.com/en-us/fabric/data-warehouse/table-constraints\n\nCorrect Sequence:\nALTER TABLE dbo.DimCustomer\n→ Prepares the table to modify its structure.\n\nADD CONSTRAINT PK_DimCustomer PRIMARY KEY CLUSTERED (CustomerKey)\n→ Adds the primary key constraint to the column. Clustered is preferred by default unless specified otherwise.\n\nENFORCED\n→ Ensures referential integrity is applied.\n\nhttps://learn.microsoft.com/en-us/fabric/data-warehouse/table-constraints \n\nCREATE TABLE PrimaryKeyTable (c1 INT NOT NULL, c2 INT);\n\nALTER TABLE PrimaryKeyTable \nADD CONSTRAINT PK_PrimaryKeyTable PRIMARY KEY NONCLUSTERED (c1) \nNOT ENFORCED;\n\nAlter table dbo.dimcustomer\nAdd constraint PK_dimcustomer primary key nonclustered (customerkey)\nnot enforced\n\nCreate a Microsoft Fabric Warehouse table with a primary key:\nCREATE TABLE PrimaryKeyTable (c1 INT NOT NULL, c2 INT);\nALTER TABLE PrimaryKeyTable ADD CONSTRAINT PK_PrimaryKeyTable PRIMARY KEY NONCLUSTERED (c1) NOT ENFORCED;\n\nProvided answer is WRONG.\nhttps://learn.microsoft.com/en-us/fabric/data-warehouse/table-constraints\nSQL analytics endpoint and Warehouse in Microsoft Fabric support these table constraints:\n\nPRIMARY KEY is only supported when NONCLUSTERED and NOT ENFORCED are both used.\n\nFOREIGN KEY is only supported when NOT ENFORCED is used.\n\nUNIQUE constraint is only supported when NONCLUSTERED and NOT ENFORCED are both used.\n\nSQL analytics endpoint and Warehouse don't support default constraints at this time.",
  "question_type": "drag_drop",
  "source": "direct_html",
  "url": "https://www.examtopics.com/discussions/microsoft/view/154903-exam-dp-700-topic-1-question-31-discussion/",
  "topic": 1,
  "question_number": 31
}